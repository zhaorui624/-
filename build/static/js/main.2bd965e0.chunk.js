(this.webpackJsonpnewssystem=this.webpackJsonpnewssystem||[]).push([[0],{275:function(e,t,n){},276:function(e,t,n){},364:function(e,t,n){},369:function(e,t,n){},471:function(e,t,n){},472:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),i=n(36),r=n.n(i),s=(n(275),n(123)),o=n(33),l=n(263),u=n(476),d=n(479),j=n(51),b=n(485),O=n(486),f=(n(276),n(17)),h=n.n(f),x=n(5);function m(e){return Object(x.jsx)("div",{style:{background:"rgb(35, 39, 65)",height:"100%",overflow:"hidden"},children:Object(x.jsxs)("div",{className:"formContainer",children:[Object(x.jsx)("div",{className:"logintitle",children:"\u5168\u7403\u65b0\u95fb\u53d1\u5e03\u7ba1\u7406\u7cfb\u7edf"}),Object(x.jsxs)(u.a,{name:"normal_login",className:"login-form",onFinish:function(t){console.log(t),h.a.get("/users?username=".concat(t.username,"&password=").concat(t.password,"&roleState=true&_expand=role")).then((function(t){console.log(t.data),0===t.data.length?l.b.error("\u7528\u6237\u540d\u6216\u5bc6\u7801\u4e0d\u5339\u914d"):(localStorage.setItem("token",JSON.stringify(t.data[0])),e.history.push("/"))}))},children:[Object(x.jsx)(u.a.Item,{name:"username",rules:[{required:!0,message:"Please input your Username!"}],children:Object(x.jsx)(d.a,{prefix:Object(x.jsx)(b.a,{className:"site-form-item-icon"}),placeholder:"Username"})}),Object(x.jsx)(u.a.Item,{name:"password",rules:[{required:!0,message:"Please input your Password!"}],children:Object(x.jsx)(d.a,{prefix:Object(x.jsx)(O.a,{className:"site-form-item-icon"}),type:"password",placeholder:"Password"})}),Object(x.jsx)(u.a.Item,{children:Object(x.jsx)(j.a,{type:"primary",htmlType:"submit",className:"login-form-button",children:"\u767b\u5f55"})})]})]})})}var p=n(19),g=n(474),v=n(70),S=(n(364),g.a.Sider),y=v.a.SubMenu,I={"/home":Object(x.jsx)(b.a,{}),"/user-manage":Object(x.jsx)(b.a,{}),"/user-manage/list":Object(x.jsx)(b.a,{}),"/right-manage":Object(x.jsx)(b.a,{}),"/right-manage/role/list":Object(x.jsx)(b.a,{}),"/right-manage/right/list":Object(x.jsx)(b.a,{})};var k=Object(o.g)((function(e){var t=Object(a.useState)([]),n=Object(p.a)(t,2),c=n[0],i=n[1];Object(a.useEffect)((function(){h.a.get("/rights?_embed=children").then((function(e){console.log(e.data),i(e.data)}))}),[]);var r=JSON.parse(localStorage.getItem("token")).role.rights,s=function(e){return e.pagepermisson&&r.includes(e.key)},o=[e.location.pathname],l=["/"+e.location.pathname.split("/")[1]];return Object(x.jsx)(S,{trigger:null,collapsible:!0,collapsed:!1,children:Object(x.jsxs)("div",{style:{display:"flex",height:"100%",flexDirection:"column"},children:[Object(x.jsx)("div",{className:"logo",children:"\u5168\u7403\u65b0\u95fb\u53d1\u5e03\u7ba1\u7406\u7cfb\u7edf"}),Object(x.jsx)("div",{style:{flex:1,overflow:"auto"},children:Object(x.jsx)(v.a,{theme:"dark",mode:"inline",selectedKeys:o,className:"aaaaaaa",defaultOpenKeys:l,children:function t(n){return n.map((function(n){var a;return(null===(a=n.children)||void 0===a?void 0:a.length)>0&&s(n)?Object(x.jsx)(y,{icon:I[n.key],title:n.title,children:t(n.children)},n.key):s(n)&&Object(x.jsx)(v.a.Item,{icon:I[n.key],onClick:function(){e.history.push(n.key)},children:n.title},n.key)}))}(c)})})]})})})),w=n(160),C=n(264),N=n(487),E=n(488),T=g.a.Header;var _=Object(o.g)((function(e){var t=Object(a.useState)(!1),n=Object(p.a)(t,2),c=n[0],i=n[1],r=function(){i(!c)},s=JSON.parse(localStorage.getItem("token")),o=s.role.roleName,l=s.username,u=Object(x.jsxs)(v.a,{children:[Object(x.jsx)(v.a.Item,{children:o}),Object(x.jsx)(v.a.Item,{danger:!0,onClick:function(){localStorage.removeItem("token"),e.history.replace("/login")},children:"\u9000\u51fa"})]});return Object(x.jsxs)(T,{className:"site-layout-background",style:{padding:"0 16px"},children:[c?Object(x.jsx)(N.a,{onClick:r}):Object(x.jsx)(E.a,{onClick:r}),Object(x.jsxs)("div",{style:{float:"right"},children:[Object(x.jsxs)("span",{children:["\u6b22\u8fce",Object(x.jsx)("span",{style:{color:"#1890ff"},children:l}),"\u56de\u6765"]}),Object(x.jsx)(w.a,{overlay:u,children:Object(x.jsx)(C.a,{size:"large",icon:Object(x.jsx)(b.a,{})})})]})]})})),P=n(191),R=n.n(P),D=(n(368),n(369),n(45));function J(){return Object(x.jsx)("div",{children:"403  Nopermission"})}var F=n(481),q=n(483),K=n(270),z=n(484),U=n(475),L=n(489),Y=n(490),B=n(130),H=F.a.confirm;var M=n(29),V=n(477),A=F.a.confirm;var G=n(129),Q=G.a.Option,W=Object(a.forwardRef)((function(e,t){var n=Object(a.useState)(!1),c=Object(p.a)(n,2),i=c[0],r=c[1];Object(a.useEffect)((function(){r(e.isUpdateDisabled)}),[e.isUpdateDisabled]);var s=JSON.parse(localStorage.getItem("token")),o=s.roleId,l=s.region,j={1:"superadmin",2:"admin",3:"editor"},b=function(t){return e.isUpdate?"superadmin"!==j[o]:"superadmin"!==j[o]&&t.value!==l},O=function(t){return e.isUpdate?"superadmin"!==j[o]:"superadmin"!==j[o]&&"editor"!==j[t.id]};return Object(x.jsxs)(u.a,{ref:t,layout:"vertical",children:[Object(x.jsx)(u.a.Item,{name:"username",label:"\u7528\u6237\u540d",rules:[{required:!0,message:"Please input the title of collection!"}],children:Object(x.jsx)(d.a,{})}),Object(x.jsx)(u.a.Item,{name:"password",label:"\u5bc6\u7801",rules:[{required:!0,message:"Please input the title of collection!"}],children:Object(x.jsx)(d.a,{})}),Object(x.jsx)(u.a.Item,{name:"region",label:"\u533a\u57df",rules:i?[]:[{required:!0,message:"Please input the title of collection!"}],children:Object(x.jsx)(G.a,{disabled:i,children:e.regionList.map((function(e){return Object(x.jsx)(Q,{value:e.value,disabled:b(e),children:e.title},e.id)}))})}),Object(x.jsx)(u.a.Item,{name:"roleId",label:"\u89d2\u8272",rules:[{required:!0,message:"Please input the title of collection!"}],children:Object(x.jsx)(G.a,{onChange:function(e){1===e?(r(!0),t.current.setFieldsValue({region:""})):r(!1)},children:e.roleList.map((function(e){return Object(x.jsx)(Q,{value:e.id,disabled:O(e),children:e.roleName},e.id)}))})})]})})),X=F.a.confirm;var Z=n(478),$=n(269),ee=n(480),te=n(88),ne=n.n(te),ae=n(258),ce=n(188),ie=n(259),re=n.n(ie);n(470);function se(e){var t=Object(a.useState)(""),n=Object(p.a)(t,2),c=n[0],i=n[1];return Object(x.jsx)("div",{style:{marginTop:50},children:Object(x.jsx)(ae.Editor,{editorState:c,toolbarClassName:"aaaaa",wrapperClassName:"bbbbb",editorClassName:"ccccc",onEditorStateChange:function(e){return i(e)},onBlur:function(){e.getContent(re()(Object(ce.convertToRaw)(c.getCurrentContent())))}})})}var oe=Z.a.Step,le=G.a.Option;var ue=n(491),de=F.a.confirm;var je=n(193),be=n.n(je),Oe=n(260),fe=n(162),he=n(196),xe=F.a.confirm;function me(e){var t=[{title:"\u65b0\u95fb\u6807\u9898",dataIndex:"title",render:function(e,t){return Object(x.jsx)("a",{href:"#/news-manage/preview/".concat(t.id),children:e})}},{title:"\u4f5c\u8005",dataIndex:"author"},{title:"\u65b0\u95fb\u5206\u7c7b",dataIndex:"category",render:function(e){return Object(x.jsx)("div",{children:e.title})}},{title:"\u64cd\u4f5c",render:function(e){return Object(x.jsx)("div",{children:Object(x.jsx)(j.a,{children:"button"})})}}];return Object(x.jsx)("div",{children:Object(x.jsx)(U.a,{dataSource:e.dataSource,columns:t,pagination:{pageSize:5},rowKey:function(e){return e.id}})})}var pe=n(482),ge=n(194),ve=n.n(ge);var Se=Z.a.Step,ye=G.a.Option;var Ie={"/home":function(){return Object(x.jsx)("div",{children:Object(x.jsx)(j.a,{type:"primary",onClick:function(){},children:"Button"})})},"/user-manage/list":function(){var e=Object(a.useState)([]),t=Object(p.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(!1),r=Object(p.a)(i,2),s=r[0],o=r[1],l=Object(a.useState)(!1),u=Object(p.a)(l,2),d=u[0],b=u[1],O=Object(a.useState)([]),f=Object(p.a)(O,2),m=f[0],g=f[1],v=Object(a.useState)([]),S=Object(p.a)(v,2),y=S[0],I=S[1],k=Object(a.useState)(null),w=Object(p.a)(k,2),C=w[0],N=w[1],E=Object(a.useState)(!1),T=Object(p.a)(E,2),_=T[0],P=T[1],R=Object(a.useRef)(null),J=Object(a.useRef)(null),q=JSON.parse(localStorage.getItem("token")),K=q.roleId,H=q.region,V=q.username;Object(a.useEffect)((function(){var e={1:"superadmin",2:"admin",3:"editor"};h.a.get("/users?_expand=role").then((function(t){var n=t.data;c("superadmin"===e[K]?n:[].concat(Object(D.a)(n.filter((function(e){return e.username===V}))),Object(D.a)(n.filter((function(t){return t.region===H&&"editor"===e[t.roleId]})))))}))}),[K,H,V]),Object(a.useEffect)((function(){h.a.get("/regions").then((function(e){var t=e.data;I(t)}))}),[]),Object(a.useEffect)((function(){h.a.get("/roles").then((function(e){var t=e.data;g(t)}))}),[]);var A=[{title:"\u533a\u57df",dataIndex:"region",filters:[].concat(Object(D.a)(y.map((function(e){return{text:e.title,value:e.value}}))),[{text:"\u5168\u7403",value:"\u5168\u7403"}]),onFilter:function(e,t){return"\u5168\u7403"===e?""===t.region:t.region===e},render:function(e){return Object(x.jsx)("b",{children:""===e?"\u5168\u7403":e})}},{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"role",render:function(e){return null===e||void 0===e?void 0:e.roleName}},{title:"\u7528\u6237\u540d",dataIndex:"username"},{title:"\u7528\u6237\u72b6\u6001",dataIndex:"roleState",render:function(e,t){return Object(x.jsx)(z.a,{checked:e,disabled:t.default,onChange:function(){return Q(t)}})}},{title:"\u64cd\u4f5c",render:function(e){return Object(x.jsxs)("div",{children:[Object(x.jsx)(j.a,{danger:!0,shape:"circle",icon:Object(x.jsx)(L.a,{}),onClick:function(){return Z(e)},disabled:e.default}),Object(x.jsx)(j.a,{type:"primary",shape:"circle",icon:Object(x.jsx)(Y.a,{}),disabled:e.default,onClick:function(){return G(e)}})]})}}],G=function(e){setTimeout((function(){b(!0),1===e.roleId?P(!0):P(!1),J.current.setFieldsValue(e)}),0),N(e)},Q=function(e){e.roleState=!e.roleState,c(Object(D.a)(n)),h.a.patch("/users/".concat(e.id),{roleState:e.roleState})},Z=function(e){X({title:"\u4f60\u786e\u5b9a\u8981\u5220\u9664?",icon:Object(x.jsx)(B.a,{}),onOk:function(){$(e)},onCancel:function(){}})},$=function(e){c(n.filter((function(t){return t.id!==e.id}))),h.a.delete("/users/".concat(e.id))};return Object(x.jsxs)("div",{children:[Object(x.jsx)(j.a,{type:"primary",onClick:function(){o(!0)},children:"\u6dfb\u52a0\u7528\u6237"}),Object(x.jsx)(U.a,{dataSource:n,columns:A,pagination:{pageSize:5},rowKey:function(e){return e.id}}),Object(x.jsx)(F.a,{visible:s,title:"\u6dfb\u52a0\u7528\u6237",okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onCancel:function(){o(!1)},onOk:function(){R.current.validateFields().then((function(e){o(!1),R.current.resetFields(),h.a.post("/users",Object(M.a)(Object(M.a)({},e),{},{roleState:!0,default:!1})).then((function(t){console.log(t.data),c([].concat(Object(D.a)(n),[Object(M.a)(Object(M.a)({},t.data),{},{role:m.filter((function(t){return t.id===e.roleId}))[0]})]))}))})).catch((function(e){console.log(e)}))},children:Object(x.jsx)(W,{regionList:y,roleList:m,ref:R})}),Object(x.jsx)(F.a,{visible:d,title:"\u66f4\u65b0\u7528\u6237",okText:"\u66f4\u65b0",cancelText:"\u53d6\u6d88",onCancel:function(){b(!1),P(!_)},onOk:function(){J.current.validateFields().then((function(e){b(!1),c(n.map((function(t){return t.id===C.id?Object(M.a)(Object(M.a)(Object(M.a)({},t),e),{},{role:m.filter((function(t){return t.id===e.roleId}))[0]}):t}))),P(!_),h.a.patch("/users/".concat(C.id),e)}))},children:Object(x.jsx)(W,{regionList:y,roleList:m,ref:J,isUpdateDisabled:_,isUpdate:!0})})]})},"/right-manage/role/list":function(){var e=Object(a.useState)([]),t=Object(p.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)([]),r=Object(p.a)(i,2),s=r[0],o=r[1],l=Object(a.useState)([]),u=Object(p.a)(l,2),d=u[0],b=u[1],O=Object(a.useState)(0),f=Object(p.a)(O,2),m=f[0],g=f[1],v=Object(a.useState)(!1),S=Object(p.a)(v,2),y=S[0],I=S[1],k=[{title:"ID",dataIndex:"id",render:function(e){return Object(x.jsx)("b",{children:e})}},{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"roleName"},{title:"\u64cd\u4f5c",render:function(e){return Object(x.jsxs)("div",{children:[Object(x.jsx)(j.a,{danger:!0,shape:"circle",icon:Object(x.jsx)(L.a,{}),onClick:function(){return w(e)}}),Object(x.jsx)(j.a,{type:"primary",shape:"circle",icon:Object(x.jsx)(Y.a,{}),onClick:function(){I(!0),b(e.rights),g(e.id)}})]})}}],w=function(e){A({title:"\u4f60\u786e\u5b9a\u8981\u5220\u9664?",icon:Object(x.jsx)(B.a,{}),onOk:function(){C(e)},onCancel:function(){}})},C=function(e){c(n.filter((function(t){return t.id!==e.id}))),h.a.delete("/roles/".concat(e.id))};return Object(a.useEffect)((function(){h.a.get("/roles").then((function(e){c(e.data)}))}),[]),Object(a.useEffect)((function(){h.a.get("/rights?_embed=children").then((function(e){o(e.data)}))}),[]),Object(x.jsxs)("div",{children:[Object(x.jsx)(U.a,{dataSource:n,columns:k,rowKey:function(e){return e.id}}),Object(x.jsx)(F.a,{title:"\u6743\u9650\u5206\u914d",visible:y,onOk:function(){console.log(d,m),I(!1),c(n.map((function(e){return e.id===m?Object(M.a)(Object(M.a)({},e),{},{rights:d}):e}))),h.a.patch("/roles/".concat(m),{rights:d})},onCancel:function(){I(!1)},children:Object(x.jsx)(V.a,{checkable:!0,checkedKeys:d,onCheck:function(e){b(e.checked)},checkStrictly:!0,treeData:s})})]})},"/right-manage/right/list":function(){var e=Object(a.useState)([]),t=Object(p.a)(e,2),n=t[0],c=t[1];Object(a.useEffect)((function(){h.a.get("/rights?_embed=children").then((function(e){var t=e.data;t.forEach((function(e){0===e.children.length&&(e.children="")})),c(t)}))}),[]);var i=[{title:"ID",dataIndex:"id",render:function(e){return Object(x.jsx)("b",{children:e})}},{title:"\u6743\u9650\u540d\u79f0",dataIndex:"title"},{title:"\u6743\u9650\u8def\u5f84",dataIndex:"key",render:function(e){return Object(x.jsx)(q.a,{color:"orange",children:e})}},{title:"\u64cd\u4f5c",render:function(e){return Object(x.jsxs)("div",{children:[Object(x.jsx)(j.a,{danger:!0,shape:"circle",icon:Object(x.jsx)(L.a,{}),onClick:function(){return s(e)}}),Object(x.jsx)(K.a,{content:Object(x.jsx)("div",{style:{textAlign:"center"},children:Object(x.jsx)(z.a,{checked:e.pagepermisson,onChange:function(){return r(e)}})}),title:"\u9875\u9762\u914d\u7f6e\u9879",trigger:void 0===e.pagepermisson?"":"click",children:Object(x.jsx)(j.a,{type:"primary",shape:"circle",icon:Object(x.jsx)(Y.a,{}),disabled:void 0===e.pagepermisson})})]})}}],r=function(e){e.pagepermisson=1===e.pagepermisson?0:1,c(Object(D.a)(n)),1===e.grade?h.a.patch("/rights/".concat(e.id),{pagepermisson:e.pagepermisson}):h.a.patch("/children/".concat(e.id),{pagepermisson:e.pagepermisson})},s=function(e){H({title:"\u4f60\u786e\u5b9a\u8981\u5220\u9664?",icon:Object(x.jsx)(B.a,{}),onOk:function(){o(e)},onCancel:function(){}})},o=function(e){if(1===e.grade)c(n.filter((function(t){return t.id!==e.id}))),h.a.delete("/rights/".concat(e.id));else{var t=n.filter((function(t){return t.id===e.rightId}));t[0].children=t[0].children.filter((function(t){return t.id!==e.id})),c(Object(D.a)(n)),h.a.delete("/children/".concat(e.id))}};return Object(x.jsx)("div",{children:Object(x.jsx)(U.a,{dataSource:n,columns:i,pagination:{pageSize:5}})})},"/news-manage/add":function(e){var t=Object(a.useState)(0),n=Object(p.a)(t,2),c=n[0],i=n[1],r=Object(a.useState)([]),s=Object(p.a)(r,2),o=s[0],b=s[1],O=Object(a.useState)({}),f=Object(p.a)(O,2),m=f[0],g=f[1],v=Object(a.useState)(""),S=Object(p.a)(v,2),y=S[0],I=S[1],k=JSON.parse(localStorage.getItem("token")),w=Object(a.useRef)(null);Object(a.useEffect)((function(){h.a.get("/categories").then((function(e){b(e.data)}))}),[]);var C=function(t){h.a.post("/news",Object(M.a)(Object(M.a)({},m),{},{content:y,region:k.region?k.region:"\u5168\u7403",author:k.username,roleId:k.roleId,auditState:t,publishState:0,createTime:Date.now(),star:0,view:0})).then((function(n){e.history.push(0===t?"/news-manage/draft":"/audit-manage/list"),$.a.info({message:"\u901a\u77e5",description:"\u60a8\u53ef\u4ee5\u5230".concat(0===t?"\u8349\u7a3f\u7bb1":"\u5ba1\u6838\u5217\u8868","\u4e2d\u67e5\u770b\u60a8\u7684\u65b0\u95fb"),placement:"bottomRight"})}))};return Object(x.jsxs)("div",{children:[Object(x.jsx)(ee.a,{className:"site-page-header",title:"\u64b0\u5199\u65b0\u95fb",subTitle:"This is a subtitle"}),Object(x.jsxs)(Z.a,{current:c,children:[Object(x.jsx)(oe,{title:"\u57fa\u672c\u4fe1\u606f",description:"\u65b0\u95fb\u6807\u9898\uff0c\u65b0\u95fb\u5206\u7c7b"}),Object(x.jsx)(oe,{title:"\u65b0\u95fb\u5185\u5bb9",description:"\u65b0\u95fb\u4e3b\u4f53\u5185\u5bb9"}),Object(x.jsx)(oe,{title:"\u65b0\u95fb\u63d0\u4ea4",description:"\u4fdd\u5b58\u8349\u7a3f\u6216\u8005\u63d0\u4ea4\u5ba1\u6838"})]}),Object(x.jsxs)("div",{style:{marginTop:"50px"},children:[Object(x.jsx)("div",{className:0===c?"":ne.a.active,children:Object(x.jsxs)(u.a,Object(M.a)(Object(M.a)({},{labelCol:{span:4},wrapperCol:{span:20}}),{},{name:"basic",ref:w,children:[Object(x.jsx)(u.a.Item,{label:"\u65b0\u95fb\u6807\u9898",name:"title",rules:[{required:!0,message:"Please input your username!"}],children:Object(x.jsx)(d.a,{})}),Object(x.jsx)(u.a.Item,{label:"\u65b0\u95fb\u5206\u7c7b",name:"categoryId",rules:[{required:!0,message:"Please input your username!"}],children:Object(x.jsx)(G.a,{children:o.map((function(e){return Object(x.jsx)(le,{value:e.id,children:e.title},e.id)}))})})]}))}),Object(x.jsx)("div",{className:1===c?"":ne.a.active,children:Object(x.jsx)(se,{getContent:function(e){I(e)}})}),Object(x.jsx)("div",{className:2===c?"":ne.a.active})]}),Object(x.jsxs)("div",{style:{marginTop:"50px"},children:[2===c&&Object(x.jsxs)("span",{children:[Object(x.jsx)(j.a,{type:"primary",onClick:function(){return C(0)},children:"\u4fdd\u5b58\u8349\u7a3f\u7bb1"}),Object(x.jsx)(j.a,{danger:!0,onClick:function(){return C(1)},children:"\u63d0\u4ea4\u5ba1\u6838"})]}),c<2&&Object(x.jsx)(j.a,{type:"primary",onClick:function(){0===c?w.current.validateFields().then((function(e){g(e),i(c+1)})).catch((function(e){console.log(e)})):""===y||"<p></p>"===y.trim()?l.b.error("\u65b0\u95fb\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a"):i(c+1)},children:"\u4e0b\u4e00\u6b65"}),c>0&&Object(x.jsx)(j.a,{onClick:function(){i(c-1)},children:"\u4e0a\u4e00\u6b65"})]})]})},"/news-manage/draft":function(e){var t=Object(a.useState)([]),n=Object(p.a)(t,2),c=n[0],i=n[1],r=JSON.parse(localStorage.getItem("token")).username;Object(a.useEffect)((function(){h.a.get("/news?author=".concat(r,"&auditState=0&_expand=category")).then((function(e){var t=e.data;i(t)}))}),[r]);var s=[{title:"ID",dataIndex:"id",render:function(e){return Object(x.jsx)("b",{children:e})}},{title:"\u65b0\u95fb\u6807\u9898",dataIndex:"title",render:function(e,t){return Object(x.jsx)("a",{href:"#/news-manage/preview/".concat(t.id),children:e})}},{title:"\u4f5c\u8005",dataIndex:"author"},{title:"\u5206\u7c7b",dataIndex:"category",render:function(e){return e.title}},{title:"\u64cd\u4f5c",render:function(t){return Object(x.jsxs)("div",{children:[Object(x.jsx)(j.a,{danger:!0,shape:"circle",icon:Object(x.jsx)(L.a,{}),onClick:function(){return l(t)}}),Object(x.jsx)(j.a,{shape:"circle",icon:Object(x.jsx)(Y.a,{}),onClick:function(){e.history.push("/news-manage/update/".concat(t.id))}}),Object(x.jsx)(j.a,{type:"primary",shape:"circle",icon:Object(x.jsx)(ue.a,{}),onClick:function(){return o(t.id)}})]})}}],o=function(t){h.a.patch("/news/".concat(t),{auditState:1}).then((function(t){e.history.push("/audit-manage/list"),$.a.info({message:"\u901a\u77e5",description:"\u60a8\u53ef\u4ee5\u5230".concat("\u5ba1\u6838\u5217\u8868","\u4e2d\u67e5\u770b\u60a8\u7684\u65b0\u95fb"),placement:"bottomRight"})}))},l=function(e){de({title:"\u4f60\u786e\u5b9a\u8981\u5220\u9664?",icon:Object(x.jsx)(B.a,{}),onOk:function(){u(e)},onCancel:function(){}})},u=function(e){i(c.filter((function(t){return t.id!==e.id}))),h.a.delete("/news/".concat(e.id))};return Object(x.jsx)("div",{children:Object(x.jsx)(U.a,{dataSource:c,columns:s,pagination:{pageSize:5},rowKey:function(e){return e.id}})})},"/news-manage/category":function(){var e=Object(a.useState)([]),t=Object(p.a)(e,2),n=t[0],i=t[1];Object(a.useEffect)((function(){h.a.get("/categories").then((function(e){i(e.data)}))}),[]);var r=function(e){i(n.map((function(t){return t.id===e.id?{id:t.id,title:e.title,value:e.title}:t}))),h.a.patch("/categories/".concat(e.id),{title:e.title,value:e.title})},s=[{title:"ID",dataIndex:"id",render:function(e){return Object(x.jsx)("b",{children:e})}},{title:"\u680f\u76ee\u540d\u79f0",dataIndex:"title",onCell:function(e){return{record:e,editable:!0,dataIndex:"title",title:"\u680f\u76ee\u540d\u79f0",handleSave:r}}},{title:"\u64cd\u4f5c",render:function(e){return Object(x.jsx)("div",{children:Object(x.jsx)(j.a,{danger:!0,shape:"circle",icon:Object(x.jsx)(L.a,{}),onClick:function(){return o(e)}})})}}],o=function(e){xe({title:"\u4f60\u786e\u5b9a\u8981\u5220\u9664?",icon:Object(x.jsx)(B.a,{}),onOk:function(){l(e)},onCancel:function(){}})},l=function(e){i(n.filter((function(t){return t.id!==e.id}))),h.a.delete("/categories/".concat(e.id))},b=c.a.createContext(null);return Object(x.jsx)("div",{children:Object(x.jsx)(U.a,{dataSource:n,columns:s,pagination:{pageSize:5},rowKey:function(e){return e.id},components:{body:{row:function(e){e.index;var t=Object(he.a)(e,["index"]),n=u.a.useForm(),a=Object(p.a)(n,1)[0];return Object(x.jsx)(u.a,{form:a,component:!1,children:Object(x.jsx)(b.Provider,{value:a,children:Object(x.jsx)("tr",Object(M.a)({},t))})})},cell:function(e){var t=e.title,n=e.editable,c=e.children,i=e.dataIndex,r=e.record,s=e.handleSave,o=Object(he.a)(e,["title","editable","children","dataIndex","record","handleSave"]),l=Object(a.useState)(!1),j=Object(p.a)(l,2),O=j[0],f=j[1],h=Object(a.useRef)(null),m=Object(a.useContext)(b);Object(a.useEffect)((function(){O&&h.current.focus()}),[O]);var g=function(){f(!O),m.setFieldsValue(Object(fe.a)({},i,r[i]))},v=function(){var e=Object(Oe.a)(be.a.mark((function e(){var t;return be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.validateFields();case 3:t=e.sent,g(),s(Object(M.a)(Object(M.a)({},r),t)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Save failed:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),S=c;return n&&(S=O?Object(x.jsx)(u.a.Item,{style:{margin:0},name:i,rules:[{required:!0,message:"".concat(t," is required.")}],children:Object(x.jsx)(d.a,{ref:h,onPressEnter:v,onBlur:v})}):Object(x.jsx)("div",{className:"editable-cell-value-wrap",style:{paddingRight:24},onClick:g,children:c})),Object(x.jsx)("td",Object(M.a)(Object(M.a)({},o),{},{children:S}))}}}})})},"/news-manage/preview/:id":function(e){var t=Object(a.useState)(null),n=Object(p.a)(t,2),c=n[0],i=n[1];return Object(a.useEffect)((function(){h.a.get("/news/".concat(e.match.params.id,"?_expand=category&_expand=role")).then((function(e){i(e.data)}))}),[e.match.params.id]),Object(x.jsx)("div",{children:c&&Object(x.jsxs)("div",{children:[Object(x.jsx)(ee.a,{onBack:function(){return window.history.back()},title:c.title,subTitle:c.category.title,children:Object(x.jsxs)(pe.b,{size:"small",column:3,children:[Object(x.jsx)(pe.b.Item,{label:"\u521b\u5efa\u8005",children:c.author}),Object(x.jsx)(pe.b.Item,{label:"\u521b\u5efa\u65f6\u95f4",children:ve()(c.createTime).format("YYYY/MM/DD HH:mm:ss")}),Object(x.jsx)(pe.b.Item,{label:"\u53d1\u5e03\u65f6\u95f4",children:c.publishTime?ve()(c.publishTime).format("YYYY/MM/DD HH:mm:ss"):"-"}),Object(x.jsx)(pe.b.Item,{label:"\u533a\u57df",children:c.region}),Object(x.jsx)(pe.b.Item,{label:"\u5ba1\u6838\u72b6\u6001",children:Object(x.jsx)("span",{style:{color:"red"},children:["\u672a\u5ba1\u6838","\u5ba1\u6838\u4e2d","\u5df2\u901a\u8fc7","\u672a\u901a\u8fc7"][c.auditState]})}),Object(x.jsx)(pe.b.Item,{label:"\u53d1\u5e03\u72b6\u6001",children:Object(x.jsx)("span",{style:{color:"red"},children:["\u672a\u53d1\u5e03","\u5f85\u53d1\u5e03","\u5df2\u4e0a\u7ebf","\u5df2\u4e0b\u7ebf"][c.publishState]})}),Object(x.jsx)(pe.b.Item,{label:"\u8bbf\u95ee\u6570\u91cf",children:c.view}),Object(x.jsx)(pe.b.Item,{label:"\u70b9\u8d5e\u6570\u91cf",children:c.star}),Object(x.jsx)(pe.b.Item,{label:"\u8bc4\u8bba\u6570\u91cf",children:"0"})]})}),Object(x.jsx)("div",{dangerouslySetInnerHTML:{__html:c.content},style:{margin:"0 24px",border:"1px solid gray"}})]})})},"/news-manage/update/:id":function(e){var t=Object(a.useState)(0),n=Object(p.a)(t,2),c=n[0],i=n[1],r=Object(a.useState)([]),s=Object(p.a)(r,2),o=s[0],b=s[1],O=Object(a.useState)({}),f=Object(p.a)(O,2),m=f[0],g=f[1],v=Object(a.useState)(""),S=Object(p.a)(v,2),y=S[0],I=S[1],k=Object(a.useRef)(null);Object(a.useEffect)((function(){h.a.get("/categories").then((function(e){b(e.data)}))}),[]),Object(a.useEffect)((function(){h.a.get("/news/".concat(e.match.params.id,"?_expand=category&_expand=role")).then((function(e){var t=e.data,n=t.title,a=t.categoryId,c=t.content;k.current.setFieldsValue({title:n,categoryId:a}),I(c)}))}),[e.match.params.id]);var w=function(t){h.a.patch("/news/".concat(e.match.params.id),Object(M.a)(Object(M.a)({},m),{},{content:y,auditState:t})).then((function(n){e.history.push(0===t?"/news-manage/draft":"/audit-manage/list"),$.a.info({message:"\u901a\u77e5",description:"\u60a8\u53ef\u4ee5\u5230".concat(0===t?"\u8349\u7a3f\u7bb1":"\u5ba1\u6838\u5217\u8868","\u4e2d\u67e5\u770b\u60a8\u7684\u65b0\u95fb"),placement:"bottomRight"})}))};return Object(x.jsxs)("div",{children:[Object(x.jsx)(ee.a,{className:"site-page-header",title:"\u66f4\u65b0\u65b0\u95fb",onBack:function(){return e.history.goBack()},subTitle:"This is a subtitle"}),Object(x.jsxs)(Z.a,{current:c,children:[Object(x.jsx)(Se,{title:"\u57fa\u672c\u4fe1\u606f",description:"\u65b0\u95fb\u6807\u9898\uff0c\u65b0\u95fb\u5206\u7c7b"}),Object(x.jsx)(Se,{title:"\u65b0\u95fb\u5185\u5bb9",description:"\u65b0\u95fb\u4e3b\u4f53\u5185\u5bb9"}),Object(x.jsx)(Se,{title:"\u65b0\u95fb\u63d0\u4ea4",description:"\u4fdd\u5b58\u8349\u7a3f\u6216\u8005\u63d0\u4ea4\u5ba1\u6838"})]}),Object(x.jsxs)("div",{style:{marginTop:"50px"},children:[Object(x.jsx)("div",{className:0===c?"":ne.a.active,children:Object(x.jsxs)(u.a,Object(M.a)(Object(M.a)({},{labelCol:{span:4},wrapperCol:{span:20}}),{},{name:"basic",ref:k,children:[Object(x.jsx)(u.a.Item,{label:"\u65b0\u95fb\u6807\u9898",name:"title",rules:[{required:!0,message:"Please input your username!"}],children:Object(x.jsx)(d.a,{})}),Object(x.jsx)(u.a.Item,{label:"\u65b0\u95fb\u5206\u7c7b",name:"categoryId",rules:[{required:!0,message:"Please input your username!"}],children:Object(x.jsx)(G.a,{children:o.map((function(e){return Object(x.jsx)(ye,{value:e.id,children:e.title},e.id)}))})})]}))}),Object(x.jsx)("div",{className:1===c?"":ne.a.active,children:Object(x.jsx)(se,{getContent:function(e){I(e)},content:y})}),Object(x.jsx)("div",{className:2===c?"":ne.a.active})]}),Object(x.jsxs)("div",{style:{marginTop:"50px"},children:[2===c&&Object(x.jsxs)("span",{children:[Object(x.jsx)(j.a,{type:"primary",onClick:function(){return w(0)},children:"\u4fdd\u5b58\u8349\u7a3f\u7bb1"}),Object(x.jsx)(j.a,{danger:!0,onClick:function(){return w(1)},children:"\u63d0\u4ea4\u5ba1\u6838"})]}),c<2&&Object(x.jsx)(j.a,{type:"primary",onClick:function(){0===c?k.current.validateFields().then((function(e){g(e),i(c+1)})).catch((function(e){console.log(e)})):""===y||"<p></p>"===y.trim()?l.b.error("\u65b0\u95fb\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a"):i(c+1)},children:"\u4e0b\u4e00\u6b65"}),c>0&&Object(x.jsx)(j.a,{onClick:function(){i(c-1)},children:"\u4e0a\u4e00\u6b65"})]})]})},"/audit-manage/audit":function(){var e=Object(a.useState)([]),t=Object(p.a)(e,2),n=t[0],c=t[1],i=JSON.parse(localStorage.getItem("token")),r=i.roleId,s=i.region,o=i.username;Object(a.useEffect)((function(){var e={1:"superadmin",2:"admin",3:"editor"};h.a.get("/news?auditState=1&_expand=category").then((function(t){var n=t.data;c("superadmin"===e[r]?n:[].concat(Object(D.a)(n.filter((function(e){return e.author===o}))),Object(D.a)(n.filter((function(t){return t.region===s&&"editor"===e[t.roleId]})))))}))}),[r,s,o]);var l=[{title:"\u65b0\u95fb\u6807\u9898",dataIndex:"title",render:function(e,t){return Object(x.jsx)("a",{href:"#/news-manage/preview/".concat(t.id),children:e})}},{title:"\u4f5c\u8005",dataIndex:"author"},{title:"\u65b0\u95fb\u5206\u7c7b",dataIndex:"category",render:function(e){return Object(x.jsx)("div",{children:e.title})}},{title:"\u64cd\u4f5c",render:function(e){return Object(x.jsxs)("div",{children:[Object(x.jsx)(j.a,{type:"primary",onClick:function(){return u(e,2,1)},children:"\u901a\u8fc7"}),Object(x.jsx)(j.a,{danger:!0,onClick:function(){return u(e,3,0)},children:"\u9a73\u56de"})]})}}],u=function(e,t,a){c(n.filter((function(t){return t.id!==e.id}))),h.a.patch("/news/".concat(e.id),{auditState:t,publishState:a}).then((function(e){$.a.info({message:"\u901a\u77e5",description:"\u60a8\u53ef\u4ee5\u5230[\u5ba1\u6838\u7ba1\u7406/\u5ba1\u6838\u5217\u8868]\u4e2d\u67e5\u770b\u60a8\u7684\u65b0\u95fb\u7684\u5ba1\u6838\u72b6\u6001",placement:"bottomRight"})}))};return Object(x.jsx)("div",{children:Object(x.jsx)(U.a,{dataSource:n,columns:l,pagination:{pageSize:5},rowKey:function(e){return e.id}})})},"/audit-manage/list":function(e){var t=Object(a.useState)([]),n=Object(p.a)(t,2),c=n[0],i=n[1],r=JSON.parse(localStorage.getItem("token")).username;Object(a.useEffect)((function(){h()("/news?author=".concat(r,"&auditState_ne=0&publishState_lte=1&_expand=category")).then((function(e){console.log(e.data),i(e.data)}))}),[r]);var s=[{title:"\u65b0\u95fb\u6807\u9898",dataIndex:"title",render:function(e,t){return Object(x.jsx)("a",{href:"#/news-manage/preview/".concat(t.id),children:e})}},{title:"\u4f5c\u8005",dataIndex:"author"},{title:"\u65b0\u95fb\u5206\u7c7b",dataIndex:"category",render:function(e){return Object(x.jsx)("div",{children:e.title})}},{title:"\u5ba1\u6838\u72b6\u6001",dataIndex:"auditState",render:function(e){return Object(x.jsx)(q.a,{color:["","orange","green","red"][e],children:["\u8349\u7a3f\u7bb1","\u5ba1\u6838\u4e2d","\u5df2\u901a\u8fc7","\u672a\u901a\u8fc7"][e]})}},{title:"\u64cd\u4f5c",render:function(e){return Object(x.jsxs)("div",{children:[1===e.auditState&&Object(x.jsx)(j.a,{onClick:function(){return o(e)},children:"\u64a4\u9500"}),2===e.auditState&&Object(x.jsx)(j.a,{danger:!0,onClick:function(){return u(e)},children:"\u53d1\u5e03"}),3===e.auditState&&Object(x.jsx)(j.a,{type:"primary",onClick:function(){return l(e)},children:"\u66f4\u65b0"})]})}}],o=function(e){i(c.filter((function(t){return t.id!==e.id}))),h.a.patch("/news/".concat(e.id),{auditState:0}).then((function(e){$.a.info({message:"\u901a\u77e5",description:"\u60a8\u53ef\u4ee5\u5230\u8349\u7a3f\u7bb1\u4e2d\u67e5\u770b\u60a8\u7684\u65b0\u95fb",placement:"bottomRight"})}))},l=function(t){e.history.push("/news-manage/update/".concat(t.id))},u=function(t){h.a.patch("/news/".concat(t.id),{publishState:2}).then((function(t){e.history.push("/publish-manage/published"),$.a.info({message:"\u901a\u77e5",description:"\u60a8\u53ef\u4ee5\u5230\u3010\u53d1\u5e03\u7ba1\u7406/\u5df2\u7ecf\u53d1\u5e03\u3011\u4e2d\u67e5\u770b\u60a8\u7684\u65b0\u95fb",placement:"bottomRight"})}))};return Object(x.jsx)("div",{children:Object(x.jsx)(U.a,{dataSource:c,columns:s,pagination:{pageSize:5},rowKey:function(e){return e.id}})})},"/publish-manage/unpublished":function(){var e=JSON.parse(localStorage.getItem("token")).username,t=Object(a.useState)([]),n=Object(p.a)(t,2),c=n[0],i=n[1];return Object(a.useEffect)((function(){h()("/news?author=".concat(e,"&publishState=1&_expand=category")).then((function(e){i(e.data)}))}),[e]),Object(x.jsx)("div",{children:Object(x.jsx)(me,{dataSource:c})})},"/publish-manage/published":function(){var e=JSON.parse(localStorage.getItem("token")).username,t=Object(a.useState)([]),n=Object(p.a)(t,2),c=n[0],i=n[1];return Object(a.useEffect)((function(){h()("/news?author=".concat(e,"&publishState=2&_expand=category")).then((function(e){i(e.data)}))}),[e]),Object(x.jsx)("div",{children:Object(x.jsx)(me,{dataSource:c})})},"/publish-manage/sunset":function(){return Object(x.jsx)("div",{children:"Sunset"})}};function ke(){var e=Object(a.useState)([]),t=Object(p.a)(e,2),n=t[0],c=t[1];Object(a.useEffect)((function(){Promise.all([h.a.get("/rights"),h.a.get("/children")]).then((function(e){c([].concat(Object(D.a)(e[0].data),Object(D.a)(e[1].data)))}))}),[]);var i=JSON.parse(localStorage.getItem("token")).role.rights;return Object(x.jsxs)(o.d,{children:[n.map((function(e){return function(e){return Ie[e.key]&&(e.pagepermisson||e.routepermisson)}(e)&&function(e){return i.includes(e.key)}(e)?Object(x.jsx)(o.b,{path:e.key,component:Ie[e.key],exact:!0},e.key):null})),Object(x.jsx)(o.a,{from:"/",to:"/home",exact:!0}),n.length>0&&Object(x.jsx)(o.b,{path:"*",component:J})]})}var we=g.a.Content;function Ce(){return R.a.start(),Object(a.useEffect)((function(){R.a.done()})),Object(x.jsxs)(g.a,{children:[Object(x.jsx)(k,{}),Object(x.jsxs)(g.a,{className:"site-layout",children:[Object(x.jsx)(_,{}),Object(x.jsx)(we,{className:"site-layout-background",style:{margin:"24px 16px",padding:24,minHeight:280,overflow:"auto"},children:Object(x.jsx)(ke,{})})]})]})}function Ne(){return Object(x.jsx)(s.a,{children:Object(x.jsxs)(o.d,{children:[Object(x.jsx)(o.b,{path:"/login",component:m}),Object(x.jsx)(o.b,{path:"/",render:function(){return localStorage.getItem("token")?Object(x.jsx)(Ce,{}):Object(x.jsx)(o.a,{to:"/login"})}})]})})}n(471);var Ee=function(){return Object(x.jsx)(Ne,{})};h.a.defaults.baseURL="http://localhost:5000",r.a.render(Object(x.jsx)(Ee,{}),document.getElementById("root"))},88:function(e,t,n){e.exports={active:"News_active__15KcG"}}},[[472,1,2]]]);
//# sourceMappingURL=main.2bd965e0.chunk.js.map